
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Motor Control &#8212; RAPcores  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/material.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="https://wavedrom.com/skins/default.js"></script>
    <script src="https://wavedrom.com/wavedrom.min.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="librapcore" href="librapcore.html" />
    <link rel="prev" title="Board Configuration" href="configuration.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=blue-grey data-md-color-accent=blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#motor_control" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="index.html" title="RAPcores  documentation"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">RAPcores</span>
          <span class="md-header-nav__topic"> Motor Control </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/rapcores/rapcores/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    RAPcores
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = ""versions.json"",
        target_loc = "../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">RAPcores  documentation</a></li>
            
            <li class="md-tabs__item"><a href="https://rapcores.org" class="md-tabs__link">News</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="index.html" title="RAPcores documentation" class="md-nav__button md-logo">
      
        <img src="_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="index.html"
       title="RAPcores documentation">RAPcores</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/rapcores/rapcores/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    RAPcores
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="releases.html" class="md-nav__link">Release Notes</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="releases.html#-030-current-development" class="md-nav__link">0.3.0 - (Current Development)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="releases.html#-020-pathfinder2" class="md-nav__link">0.2.0 - “Pathfinder2”</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="releases.html#-010-pathfinder" class="md-nav__link">0.1.0 - “Pathfinder”</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="interfaces.html" class="md-nav__link">Software Programs</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="interfaces.html#rapcore-cli" class="md-nav__link">RAPcore-cli</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="interfaces.html#interactive-spi-using-raspi-julia" class="md-nav__link">Interactive SPI using RasPi + Julia</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="spi_spec.html" class="md-nav__link">SPI Specification</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="spi_spec.html#definitions" class="md-nav__link">Definitions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="spi_spec.html#versioning" class="md-nav__link">Versioning</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="spi_spec.html#overview" class="md-nav__link">Overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="spi_spec.html#statusconfig-commands-0xf1-0xf2" class="md-nav__link">Status/Config Commands - (0xf1 0xf2)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="spi_spec.html#coordinated-step-timer-0x01" class="md-nav__link">Coordinated Step Timer - 0x01</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="register_map.html" class="md-nav__link">Register Map</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="register_map.html#configuration-register-read-write" class="md-nav__link">Configuration Register - Read/Write</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="register_map.html#status-register-read-only" class="md-nav__link">Status Register - Read Only</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="configuration.html" class="md-nav__link">Board Configuration</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="configuration.html#makefile-mk-parameters" class="md-nav__link">Makefile (.mk) Parameters</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="configuration.html#spi-interface" class="md-nav__link">SPI Interface</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="configuration.html#pwm" class="md-nav__link">PWM</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="configuration.html#motors" class="md-nav__link">Motors</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="configuration.html#encoders" class="md-nav__link">Encoders</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="configuration.html#flow-control-and-events" class="md-nav__link">Flow Control and Events</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="configuration.html#move-buffer-size" class="md-nav__link">Move Buffer Size</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="configuration.html#dda" class="md-nav__link">DDA</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="configuration.html#internal-register-sizes" class="md-nav__link">Internal Register Sizes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="configuration.html#led" class="md-nav__link">LED</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="configuration.html#logic-analyzer" class="md-nav__link">Logic Analyzer</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Motor Control </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Motor Control</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#motor-control--page-root" class="md-nav__link">Motor Control</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#electrical-commutation" class="md-nav__link">Electrical Commutation</a>
        </li>
        <li class="md-nav__item"><a href="#bridge-control" class="md-nav__link">Bridge Control</a>
        </li>
        <li class="md-nav__item"><a href="#motor-fault-types" class="md-nav__link">Motor Fault Types</a>
        </li>
        <li class="md-nav__item"><a href="#space-vector-modulation" class="md-nav__link">Space Vector Modulation</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#vector-concepts" class="md-nav__link">Vector Concepts</a>
        </li>
        <li class="md-nav__item"><a href="#pwm-concepts" class="md-nav__link">PWM Concepts</a>
        </li>
        <li class="md-nav__item"><a href="#applied-space-vector-modulation" class="md-nav__link">Applied Space Vector Modulation</a>
        </li>
        <li class="md-nav__item"><a href="#svm-in-three-phase" class="md-nav__link">SVM in Three Phase</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#frequency-considerations" class="md-nav__link">Frequency Considerations</a>
        </li>
        <li class="md-nav__item"><a href="#commutation-tables" class="md-nav__link">Commutation Tables</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#bipolar-stepper" class="md-nav__link">Bipolar Stepper</a>
        </li>
        <li class="md-nav__item"><a href="#three-phase-bldc-induction" class="md-nav__link">Three Phase (BLDC, Induction)</a>
        </li>
        <li class="md-nav__item"><a href="#five-phase-stepper" class="md-nav__link">Five Phase Stepper</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#analytical-models" class="md-nav__link">Analytical Models</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#stepper-motor" class="md-nav__link">Stepper Motor</a>
        </li>
        <li class="md-nav__item"><a href="#motoring-quadrants" class="md-nav__link">Motoring Quadrants</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#references" class="md-nav__link">References</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="_sources/motor_control.rst.txt">Show Source</a> </li>

  </ul>
</nav>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="#electrical-commutation" class="md-nav__link">Electrical Commutation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#bridge-control" class="md-nav__link">Bridge Control</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#motor-fault-types" class="md-nav__link">Motor Fault Types</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#space-vector-modulation" class="md-nav__link">Space Vector Modulation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#frequency-considerations" class="md-nav__link">Frequency Considerations</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#commutation-tables" class="md-nav__link">Commutation Tables</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#analytical-models" class="md-nav__link">Analytical Models</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#references" class="md-nav__link">References</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="librapcore.html" class="md-nav__link">librapcore</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="asic.html" class="md-nav__link">RAPcores on ASIC</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="asic.html#mpw-one" class="md-nav__link">MPW-one</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="dev.html" class="md-nav__link">Developer Docs</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="dev.html#build-prerequisites" class="md-nav__link">Build Prerequisites</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="dev.html#overview-of-make-targets" class="md-nav__link">Overview of Make targets</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="dev.html#board-targets" class="md-nav__link">Board targets</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="dev.html#formal-verification" class="md-nav__link">Formal Verification</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="dev.html#test-benches" class="md-nav__link">Test Benches</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="dev.html#formatting" class="md-nav__link">Formatting</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="dev.html#linting" class="md-nav__link">Linting</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="dev.html#developing-with-nix" class="md-nav__link">Developing with Nix</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="dev.html#helpful-articles" class="md-nav__link">Helpful Articles</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="dev.html#useful-tools" class="md-nav__link">Useful Tools</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html" class="md-nav__link">Verilog Modules</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="internals.html#microstepper-top" class="md-nav__link">microstepper_top</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#spi-state-machine" class="md-nav__link">spi_state_machine</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#quad-enc" class="md-nav__link">quad_enc</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#dda-timer" class="md-nav__link">dda_timer</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#mytimer" class="md-nav__link">mytimer</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#analog-out" class="md-nav__link">analog_out</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#mytimer-8" class="md-nav__link">mytimer_8</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#spi-pll-ice40-64" class="md-nav__link">spi_pll_ice40_64</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#edge-detector" class="md-nav__link">edge_detector</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#dda-fsm" class="md-nav__link">dda_fsm</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#pwm-pll-ice40-140" class="md-nav__link">pwm_pll_ice40_140</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#pwm" class="md-nav__link">pwm</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#dual-hbridge" class="md-nav__link">dual_hbridge</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#microstep-counter" class="md-nav__link">microstep_counter</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#pwm-pll" class="md-nav__link">pwm_pll</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#chargepump" class="md-nav__link">chargepump</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#pwm-pll-ecp5-150" class="md-nav__link">pwm_pll_ecp5_150</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#clock-divider" class="md-nav__link">clock_divider</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#spi" class="md-nav__link">spi</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#mytimer-10" class="md-nav__link">mytimer_10</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#cosine" class="md-nav__link">cosine</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#spi-pll-ecp5-64" class="md-nav__link">spi_pll_ecp5_64</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#microstepper-control" class="md-nav__link">microstepper_control</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#pwm-pll-ecp5-200" class="md-nav__link">pwm_pll_ecp5_200</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#space-vector-modulator" class="md-nav__link">space_vector_modulator</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#rapcore" class="md-nav__link">rapcore</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="internals.html#register-input" class="md-nav__link">register_input</a>
      
    
    </li></ul>
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#motor-control--page-root" class="md-nav__link">Motor Control</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#electrical-commutation" class="md-nav__link">Electrical Commutation</a>
        </li>
        <li class="md-nav__item"><a href="#bridge-control" class="md-nav__link">Bridge Control</a>
        </li>
        <li class="md-nav__item"><a href="#motor-fault-types" class="md-nav__link">Motor Fault Types</a>
        </li>
        <li class="md-nav__item"><a href="#space-vector-modulation" class="md-nav__link">Space Vector Modulation</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#vector-concepts" class="md-nav__link">Vector Concepts</a>
        </li>
        <li class="md-nav__item"><a href="#pwm-concepts" class="md-nav__link">PWM Concepts</a>
        </li>
        <li class="md-nav__item"><a href="#applied-space-vector-modulation" class="md-nav__link">Applied Space Vector Modulation</a>
        </li>
        <li class="md-nav__item"><a href="#svm-in-three-phase" class="md-nav__link">SVM in Three Phase</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#frequency-considerations" class="md-nav__link">Frequency Considerations</a>
        </li>
        <li class="md-nav__item"><a href="#commutation-tables" class="md-nav__link">Commutation Tables</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#bipolar-stepper" class="md-nav__link">Bipolar Stepper</a>
        </li>
        <li class="md-nav__item"><a href="#three-phase-bldc-induction" class="md-nav__link">Three Phase (BLDC, Induction)</a>
        </li>
        <li class="md-nav__item"><a href="#five-phase-stepper" class="md-nav__link">Five Phase Stepper</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#analytical-models" class="md-nav__link">Analytical Models</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#stepper-motor" class="md-nav__link">Stepper Motor</a>
        </li>
        <li class="md-nav__item"><a href="#motoring-quadrants" class="md-nav__link">Motoring Quadrants</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#references" class="md-nav__link">References</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="_sources/motor_control.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="motor-control">
<h1 id="motor-control--page-root">Motor Control<a class="headerlink" href="#motor-control--page-root" title="Permalink to this headline">¶</a></h1>
<p>This section describes the principles of motor control at a low level.</p>
<section id="electrical-commutation">
<h2 id="electrical-commutation">Electrical Commutation<a class="headerlink" href="#electrical-commutation" title="Permalink to this headline">¶</a></h2>
<p>Electrical commutation is the process of generating rotating magnetic fields in
an electromagnetic system. In electric motors this involves the generation of AC and DC
signals. Some simple motors may do this mechanically, however for precision applications
such as robotics and manufacturing it is done with digital control systems.</p>
<p>Many types of motors may be controlled with electrical commutation:</p>
<ul class="simple">
<li><p>Brushless DC</p></li>
<li><p>Induction</p></li>
<li><p>Stepper</p></li>
<li><p>Switched Reluctance</p></li>
</ul>
<p>There are of course many innovative topologies being developed every year, and
many of these use the same operating principles as the above. RAPcores aims
to provide a toolkit for controlling a wide range of motor types.</p>
<p>The two basic elements of a motor controller are:</p>
<ul class="simple">
<li><p>Power systems</p></li>
<li><p>Control systems</p></li>
</ul>
<p>The power systems element is the element that handle the (relatively) high
power that drives the motor. Typically MOSFETs or IGBTs are used in full or H bridge
inverter configurations to generate AC voltages. It may include additional sensors such as an
encoder, voltage sensor, and current sensor. All three are preferred for
closed-loop control.</p>
<p>The control systems element is the software or digital logic system managing
inputs and outputs of the power circuitry, sensors, and input trajectories.
In RAPcores the low levels of this are handled in FPGA or ASIC, with a
microcontroller or CPU handling high level trajectory planning. The job of the
control system is to ensure the motor is following the defined trajectory or
set behavior.</p>
</section>
<section id="bridge-control">
<h2 id="bridge-control">Bridge Control<a class="headerlink" href="#bridge-control" title="Permalink to this headline">¶</a></h2>
<p>Below is a simple motor control hierarchy:</p>
<img alt="_images/controller-hierarchy.svg" src="_images/controller-hierarchy.svg"/><p>Bridge control involves the timing of output signals such that
the motor power circuitry creates the desires voltage and current
in each coil of the motor. In addition, it needs to be fault aware
and control timing to create smooth operation. Typically high-resolution
PWM signals are used at supra-audible frequencies (&gt;35kHz).</p>
<p>Due to the use of PWM and commutation, the voltages are non-contant. There
are some timing considerations when switching the motor:</p>
<ul class="simple">
<li><p>Dead time</p></li>
<li><p>Off time</p></li>
<li><p>On time</p></li>
<li><p>Blank time</p></li>
</ul>
<p>Dead time is the time required for a transistor in the bridge to turn on or off.
When switching polarities, it is important the controller wait this “dead time”,
or delay, before changing the direction of the inverter otherwise breakage might occur.</p>
<p>Off time and On time are the duration the PWM signal is on or off. The relation of
these two is relevant to current and voltage measurements of the motor. Measuring
voltage and current over time allows for measurement of resistance and inductance
in the motor.</p>
<p>Blank time is related to the propogation delay of measuring the outputs to the motor.
Since a digital design can react on a cycle-to-cycle basis of the PWM, delays
must be accounted in elements such as ADCs and comparators before measuring
then reacting to a change in the power output.</p>
</section>
<section id="motor-fault-types">
<h2 id="motor-fault-types">Motor Fault Types<a class="headerlink" href="#motor-fault-types" title="Permalink to this headline">¶</a></h2>
<p>The following faults may occur in a motor:</p>
<ul class="simple">
<li><p>Disconnection</p></li>
<li><p>Overcurrent</p></li>
<li><p>Undervoltage</p></li>
<li><p>Thermal Shutdown</p></li>
<li><p>Overvoltage</p></li>
</ul>
<p>A good bridge design should be able to handle the majority of these
fault conditions and report back to higher level controllers for
rectification by the user or path planner. In RAPcores there are
fault diagnostic registers for each motor channel.</p>
</section>
<section id="space-vector-modulation">
<h2 id="space-vector-modulation">Space Vector Modulation<a class="headerlink" href="#space-vector-modulation" title="Permalink to this headline">¶</a></h2>
<p>The key to smooth and efficient motor control is a high precision electrical commutator.
To achieve this, precise currents and voltages must be generated. Moreover, they
must rotate the magnetic field at a wide variety of speeds and accelerations.
As mentioned, PWM signals are used to control the power output and to rotate the
magnetic field with PWM, we use a Space Vector Modulator.</p>
<p>Two elements are required for Space Vector Modulation or SVM:</p>
<ul class="simple">
<li><p>Microstepping (subdividing the commutation table)</p></li>
<li><p>Current regulation (limiting power output for efficiency)</p></li>
</ul>
<p>To understand the concepts and mathematics of the rotating magnetic field,
we will use vectors and phasors.</p>
<section id="vector-concepts">
<h3 id="vector-concepts">Vector Concepts<a class="headerlink" href="#vector-concepts" title="Permalink to this headline">¶</a></h3>
<p>Here we will present the mathematical ideas of how to model a rotating magnetic field in a bipolar stepper
motor as a vector. This is known as <a class="reference external" href="https://en.wikipedia.org/wiki/Space_vector_modulation">Space Vector Modulation</a>.
To start we must understand some basic concepts from vector algebra and trigonometry.</p>
<p>Recall that sine and cosine are derived from the components of a vector rotating around the origin:</p>
<img alt="https://upload.wikimedia.org/wikipedia/commons/b/bd/Sine_and_cosine_animation.gif" src="https://upload.wikimedia.org/wikipedia/commons/b/bd/Sine_and_cosine_animation.gif"/>
<p>And recall the identity where:</p>
<div class="math notranslate nohighlight">
\[cos(\theta)^2+sin(\theta)^2=1\]</div>
<p>Or alternatively:</p>
<div class="math notranslate nohighlight">
\[A \cdot cos(\theta)^2+A \cdot sin(\theta)^2=A\]</div>
<p>The above equation is essential in our understanding of constructing the vector. Recall the phase table for the bipolar stepper:</p>
<table>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>A</p></th>
<th class="head"><p>B</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>+</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>-</p></td>
<td><p>+</p></td>
</tr>
<tr class="row-odd"><td><p>+</p></td>
<td><p>+</p></td>
</tr>
</tbody>
</table>
<p>If we visualize each phase as a 2D plot we can see these commutation steps form the corners of a square as shown below:</p>
<img alt="_images/bipolar-svm.svg" src="_images/bipolar-svm.svg"/><p>Microstepping is possible in this space (a square), however it yields undesirable effects since the total current in the motor
varies due to a change of vector length as shown in the red arrow above. This can yield resonance and torque ripples. The objective
is to create smooth motion as we traverse between the phases. Therefore we need to move our vector along a circle, such as the arrows in blue above. The trade-off is
that we do not achieve the peak torque attainable in the corners of the square, but instead the motion is smooth and controllable.</p>
</section>
<section id="pwm-concepts">
<h3 id="pwm-concepts">PWM Concepts<a class="headerlink" href="#pwm-concepts" title="Permalink to this headline">¶</a></h3>
<p>Below is a simple PWM module in verilog:</p>
<div class="highlight-verilog notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>  <span class="cm">/*</span>
<span class="linenos"> 2</span><span class="cm">  Simple PWM module</span>
<span class="linenos"> 3</span><span class="cm">  */</span>
<span class="linenos"> 4</span>  <span class="k">module</span> <span class="n">pwm</span> <span class="p">#(</span>
<span class="linenos"> 5</span>      <span class="k">parameter</span> <span class="n">bits</span> <span class="o">=</span> <span class="mh">8</span>
<span class="linenos"> 6</span>  <span class="p">)</span> <span class="p">(</span>
<span class="linenos"> 7</span>      <span class="k">input</span>  <span class="n">clk</span><span class="p">,</span>
<span class="linenos"> 8</span>      <span class="k">input</span>  <span class="n">resetn</span><span class="p">,</span>
<span class="linenos"> 9</span>      <span class="k">input</span>  <span class="p">[</span><span class="n">bits</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">val</span><span class="p">,</span>
<span class="linenos">10</span>      <span class="k">output</span> <span class="n">pwm</span>
<span class="linenos">11</span>  <span class="p">);</span>
<span class="linenos">12</span>
<span class="linenos">13</span>    <span class="kt">reg</span> <span class="p">[</span><span class="n">bits</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">accum</span><span class="p">;</span>
<span class="linenos">14</span>    <span class="k">assign</span> <span class="n">pwm</span> <span class="o">=</span> <span class="p">(</span><span class="n">accum</span> <span class="o">&lt;</span> <span class="n">val</span><span class="p">);</span>
<span class="linenos">15</span>
<span class="linenos">16</span>    <span class="k">always</span> <span class="p">@(</span><span class="k">posedge</span> <span class="n">clk</span><span class="p">)</span>
<span class="linenos">17</span>    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">resetn</span><span class="p">)</span>
<span class="linenos">18</span>      <span class="n">accum</span> <span class="o">&lt;=</span> <span class="mh">0</span><span class="p">;</span>
<span class="linenos">19</span>    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">resetn</span><span class="p">)</span>
<span class="linenos">20</span>      <span class="n">accum</span> <span class="o">&lt;=</span> <span class="n">accum</span> <span class="o">+</span> <span class="mh">1</span><span class="mb">'b1</span><span class="p">;</span>
<span class="linenos">21</span>
<span class="linenos">22</span>  <span class="k">endmodule</span>
</pre></div>
</div>
<p>We can see that the PWM output frequency is a function of the base clock frequency (<cite>clk</cite>) and the number of bits used for the accumulator. E.g.:</p>
<div class="math notranslate nohighlight">
\[F_{PMW} = \frac{F_{clk}}{2^{bits}}\]</div>
<p>For quiet operation and fast updates we want the PWM frequency to be superaudible, so a value greater than 30khz. Assume we use a PLL to achieve
a higher operational frequency for <cite>PWM</cite> module at 150mhz. The bit resolution of the PWM can be calculated thus:</p>
<div class="math notranslate nohighlight">
\[bits = \log_2({F_{PMW}/F_{clk}})\]</div>
<p>In our example of a 30khz output with a 150mhz accumulator clock we get ~12.3 bit resolution. For simplicity we will use 12 bits going forward.</p>
<p>Now the challenge is how to compute the value to the PWM such that we bring both the current and the microstep/phase angle into a single value.
In the next section we will see this is a relatively straight forward process that falls out of the vector model.</p>
</section>
<section id="applied-space-vector-modulation">
<h3 id="applied-space-vector-modulation">Applied Space Vector Modulation<a class="headerlink" href="#applied-space-vector-modulation" title="Permalink to this headline">¶</a></h3>
<p>Recall that a vector (<span class="math notranslate nohighlight">\(\vec{A}\)</span>) may be element-wise scaled by a given factor such that the length (<span class="math notranslate nohighlight">\(\left\lVert\vec{A}\right\rVert\)</span>) is scaled by the same factor.
Our vector is formed from a given angle (or microstep position) <span class="math notranslate nohighlight">\(\theta\)</span> as: <span class="math notranslate nohighlight">\((cos(\theta), sin(\theta))\)</span>. Then scaling the current is simply multiplication of this vector
by a factor <cite>C</cite>: <span class="math notranslate nohighlight">\((C \cdot cos(\theta), C \cdot sin(\theta))\)</span>. Then using the above identify we known that the length of this vector is:</p>
<div class="math notranslate nohighlight">
\[\left\lVert(C \cdot cos(\theta), C \cdot sin(\theta))\right\rVert = C\]</div>
<p>Then the matter of partitioning the 12 bit space of the PWM become quite simple. For example we may use 8 bits for the trigonometric functions (implemented as lookup tables in practice), and 4 bits for current.
Which gives sufficient precision for 64 microsteps and 16 discrete current values.</p>
<p>So now we can do space vector modulation. But where do we put it? The answer is as a voltage reference or gate PWM input. For example we may use this output to
create a reference for a 1-bit ADC by adding a RC filter to the output in a <a class="reference external" href="https://en.wikipedia.org/wiki/Chopper_(electronics)">chopper drive</a>.
Or for a dead-reckoned approach this PWM can be used to quickly turn the gate drivers on and off. An example of this can be found in the RAPcores Dual H Bridge module.</p>
</section>
<section id="svm-in-three-phase">
<h3 id="svm-in-three-phase">SVM in Three Phase<a class="headerlink" href="#svm-in-three-phase" title="Permalink to this headline">¶</a></h3>
<p>For the mathematically inclined, you may notice that the bipolar stepper is nice
as the phases form an orthonormal basis in 2D space. In three phase or more motors, this is not the case,
as the vector is embedded in three or more dimensional space.</p>
<p>The technique used in three phase control is to project the three dimensional vector down into a two dimensional
space such that we can use simpler math for the control. In addition, the inverse may be applied, bringing us
from the two dimensional frame of reference to the three dimensional frame of reference for the three phase motor.</p>
<p>The forward transform:</p>
<div class="math notranslate nohighlight">
\[\begin{split}i_{\alpha\beta}(t) = \frac23 \begin{bmatrix} 1 &amp; -\frac12 &amp; -\frac12\\
0 &amp; \frac{\sqrt{3}}{2} &amp; -\frac{\sqrt{3}}{2}
\end{bmatrix}\begin{bmatrix}i_a(t)\\i_b(t)\\i_c(t)\end{bmatrix}\end{split}\]</div>
<p>The inverse transform:</p>
<div class="math notranslate nohighlight">
\[\begin{split}i_{abc}(t) = \frac32\begin{bmatrix} \frac23 &amp; 0 \\
-\frac{1}{3} &amp; \frac{\sqrt{3}}{3} \\
-\frac{1}{3} &amp; -\frac{\sqrt{3}}{3} \end{bmatrix}
\begin{bmatrix}i_\alpha(t)\\i_\beta(t)\end{bmatrix}\end{split}\]</div>
</section>
</section>
<section id="frequency-considerations">
<h2 id="frequency-considerations">Frequency Considerations<a class="headerlink" href="#frequency-considerations" title="Permalink to this headline">¶</a></h2>
<p>Below is a table showing some relevant stepping frequencies for a stock Prusa MK3S:</p>
<table>
<colgroup>
<col style="width: 53%"/>
<col style="width: 11%"/>
<col style="width: 11%"/>
<col style="width: 13%"/>
<col style="width: 11%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Prusa MK3S</p></th>
<th class="head"><p>X</p></th>
<th class="head"><p>Y</p></th>
<th class="head"><p>Z</p></th>
<th class="head"><p>E</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Full Steps/rev</p></td>
<td><p>200</p></td>
<td><p>200</p></td>
<td><p>200</p></td>
<td><p>200</p></td>
</tr>
<tr class="row-odd"><td><p>Microsteps</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
<td><p>16</p></td>
<td><p>32</p></td>
</tr>
<tr class="row-even"><td><p>Homing Feedrate (mm/sec)</p></td>
<td><p>50</p></td>
<td><p>50</p></td>
<td><p>13.3</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Max travel Rate (mm/sec)</p></td>
<td><p>200</p></td>
<td><p>200</p></td>
<td><p>12</p></td>
<td><p>120</p></td>
</tr>
<tr class="row-even"><td><p>(Steps*microsteps)/mm</p></td>
<td><p>100</p></td>
<td><p>100</p></td>
<td><p>400</p></td>
<td><p>280</p></td>
</tr>
<tr class="row-odd"><td><p>Microsteps/sec (travel)</p></td>
<td><p>20000</p></td>
<td><p>20000</p></td>
<td><p>4800</p></td>
<td><p>33600</p></td>
</tr>
<tr class="row-even"><td><p>Full Steps/sec (travel)</p></td>
<td><p>1250</p></td>
<td><p>1250</p></td>
<td><p>300</p></td>
<td><p>1050</p></td>
</tr>
<tr class="row-odd"><td><p>Microsteps/sec (homing)</p></td>
<td><p>5000</p></td>
<td><p>5000</p></td>
<td><p>5333.3</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Full Steps/sec (homing)</p></td>
<td><p>312.5</p></td>
<td><p>312.5</p></td>
<td><p>333.3</p></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="commutation-tables">
<h2 id="commutation-tables">Commutation Tables<a class="headerlink" href="#commutation-tables" title="Permalink to this headline">¶</a></h2>
<section id="bipolar-stepper">
<h3 id="bipolar-stepper">Bipolar Stepper<a class="headerlink" href="#bipolar-stepper" title="Permalink to this headline">¶</a></h3>
<table>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>A</p></th>
<th class="head"><p>B</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>+</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>-</p></td>
<td><p>+</p></td>
</tr>
<tr class="row-odd"><td><p>+</p></td>
<td><p>+</p></td>
</tr>
</tbody>
</table>
</section>
<section id="three-phase-bldc-induction">
<h3 id="three-phase-bldc-induction">Three Phase (BLDC, Induction)<a class="headerlink" href="#three-phase-bldc-induction" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><table>
<colgroup>
<col style="width: 33%"/>
<col style="width: 33%"/>
<col style="width: 33%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>A</p></th>
<th class="head"><p>B</p></th>
<th class="head"><p>C</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>+</p></td>
<td><p>-</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>+</p></td>
<td><p></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>+</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>-</p></td>
<td><p>+</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>-</p></td>
<td><p></p></td>
<td><p>+</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>-</p></td>
<td><p>+</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</section>
<section id="five-phase-stepper">
<h3 id="five-phase-stepper">Five Phase Stepper<a class="headerlink" href="#five-phase-stepper" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 20%"/>
<col style="width: 20%"/>
<col style="width: 20%"/>
<col style="width: 20%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>A</p></th>
<th class="head"><p>B</p></th>
<th class="head"><p>C</p></th>
<th class="head"><p>D</p></th>
<th class="head"><p>E</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>+</p></td>
<td><p></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>+</p></td>
<td><p>+</p></td>
<td><p></p></td>
<td><p>-</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>+</p></td>
<td><p></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>+</p></td>
<td><p>+</p></td>
<td><p></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>-</p></td>
<td><p></p></td>
<td><p>+</p></td>
<td><p></p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>-</p></td>
<td><p></p></td>
<td><p>+</p></td>
<td><p>+</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>-</p></td>
<td><p>-</p></td>
<td><p></p></td>
<td><p>+</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>-</p></td>
<td><p></p></td>
<td><p>+</p></td>
<td><p>+</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p></p></td>
<td><p>+</p></td>
</tr>
<tr class="row-odd"><td><p>+</p></td>
<td><p></p></td>
<td><p>-</p></td>
<td><p></p></td>
<td><p>+</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</section>
</section>
<section id="analytical-models">
<h2 id="analytical-models">Analytical Models<a class="headerlink" href="#analytical-models" title="Permalink to this headline">¶</a></h2>
<section id="stepper-motor">
<h3 id="stepper-motor">Stepper Motor<a class="headerlink" href="#stepper-motor" title="Permalink to this headline">¶</a></h3>
<p>A model of a hybrid stepper motor is given by Bodson, et. al.: [1]</p>
<div class="math notranslate nohighlight">
\[\frac{d \theta}{dt} = \omega\]</div>
<div class="math notranslate nohighlight">
\[\frac{d \omega}{dt} = ( -K_m i_a sin(N_r \theta) + K_m i_b cos(N_r \theta) - B \omega - \tau)/J\]</div>
<div class="math notranslate nohighlight">
\[\frac{d i_a}{dt} = ( v_a - R i_a + K_m sin(N_r \theta))/L\]</div>
<div class="math notranslate nohighlight">
\[\frac{i_b}{dt} = ( v_b - R i_b - K_m cos(N_r \theta))/L\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\omega\)</span> - Angular Velocity</p></li>
<li><p><span class="math notranslate nohighlight">\(\theta\)</span> - Angular Position</p></li>
<li><p><span class="math notranslate nohighlight">\(J\)</span> - Rotor and Load Inertia</p></li>
<li><p><span class="math notranslate nohighlight">\(K_m\)</span> - Motor Torque constant</p></li>
<li><p><span class="math notranslate nohighlight">\(L\)</span> - Coil Inductance</p></li>
<li><p><span class="math notranslate nohighlight">\(R\)</span> - Coil Resistance</p></li>
<li><p><span class="math notranslate nohighlight">\(N_r\)</span> - Number of rotor teeth</p></li>
<li><p><span class="math notranslate nohighlight">\(i_a, i_b\)</span> - Coil Current</p></li>
<li><p><span class="math notranslate nohighlight">\(v_a, v_b\)</span> - Coil Current</p></li>
</ul>
<p>From this a simpler model for the current can be developed:</p>
<div class="math notranslate nohighlight">
\[i_{qr} = \frac{J}{K_m} \alpha_r + \frac{B}{K_m} \omega_r\]</div>
</section>
<section id="motoring-quadrants">
<h3 id="motoring-quadrants">Motoring Quadrants<a class="headerlink" href="#motoring-quadrants" title="Permalink to this headline">¶</a></h3>
<p>Motoring quadrants are the four possible states a rotor and stator may take. Assuming
the stator is the driving portion and the rotor is connected to the load, either maybe
generating torque in conjunction or opposition to the desired motoring trajectory.
These states are illustrated below:</p>
<img alt="_images/motoring-quadrants.svg" src="_images/motoring-quadrants.svg"/></section>
</section>
<section id="references">
<h2 id="references">References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>[1]M. Bodson and J. N. Chiasson, “High-Performance Nonlinear Feedback Control of a Permanent Magnet Stepper Motor,” p. 10.</p>
</section>
</section>
<script type="text/javascript">
        function init() {
            WaveDrom.ProcessAll();
        }
        window.onload = init;
    </script>

          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="configuration.html" title="Board Configuration"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Board Configuration </span>
              </div>
            </a>
          
          
            <a href="librapcore.html" title="librapcore"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> librapcore </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2019-1980, RAPcore developers.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.0.2.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>